# 修复影响检查 (Fix Impact Analysis)

对当前修改进行全面影响分析，检查是否对其他逻辑造成破坏。

## 检查维度

### 1️⃣ 直接影响分析
- 修改的函数/方法被哪些地方调用？
- 修改的参数签名是否向后兼容？
- 返回值类型/结构是否发生变化？

### 2️⃣ 间接影响分析
- 调用链上下游的数据流向
- 共享状态/全局变量的修改
- 事件监听器/回调函数的触发时机

### 3️⃣ 数据结构兼容性
- 新增字段: 旧数据读取时是否有默认值？
- 删除字段: 是否有代码仍在访问该字段？
- 类型变更: string→number 等隐式转换

### 4️⃣ 潜在风险点
- 空值/undefined 访问
- 异步操作的竞态条件
- 内存泄漏风险
- 性能回退

## 输出格式

请按以下格式输出分析报告：

```
📝 变更更摘要
├─ 修改文件: [文件路径]
├─ 修改类型: [修复/重构/新增/删除]
├─ 影响范围: [局部/模块级/全局]
└─ 风险等级: 🟢低 / 🟡中 / 🔴高

🎯 直接影响
├─ 调用方 (N 处):
│  ├─ 文件:行号 - 函数名() ⚠️ 需要检查 / ✅ 兼容
│  └─ ...
└─ 依赖项 (N 个):
   ├─ 依赖名 - 版本要求 ⚠️ / ✅
   └─ ...

🔗 间接影响
├─ 数据流向:
│  └─ 描述变化对数据流的影响
├─ 共享状态:
│  └─ 全局变量/单例的变更影响
└─ 事件触发:
   └─ 回调/监听器的时机变化

⚠️ 潜在问题
├─ [问题描述]
│  ├─ 影响: ...
│  ├─ 建议修复: ...
│  └─ 优先级: 高/中/低
└─ ...

✅ 兼容性检查
├─ 参数兼容: ✅ / ⚠️
├─ 返回值兼容: ✅ / ⚠️
├─ 数据结构兼容: ✅ / ⚠️
└─ 依赖兼容: ✅ / ⚠️
```

## 执行步骤

1. 识别当前修改的内容和范围
2. 搜索所有调用方和依赖
3. 分析调用链和数据流
4. 检查兼容性和潜在风险
5. 生成上述格式的分析报告
